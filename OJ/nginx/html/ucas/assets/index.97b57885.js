import{d as e,u as t,r as n}from"./index.437ff7e1.js";import{B as o,C as l,D as i,E as s,G as a,H as r,d as c,g as u,z as d,r as p,o as f,c as m,b as g,j as y,k as v,t as b,A as h,m as C}from"./vendor.89c38d11.js";import"./dateformat.2852d5e6.js";var w={};Object.defineProperty(w,"__esModule",{value:!0});var x=o,_=s,k=l,S=a,T=i;function M(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var B=M(r),N=M(S);const D={success:"success",info:"info",warning:"warning",error:"error"};var O=x.defineComponent({name:"ElNotification",props:{customClass:{type:String,default:""},dangerouslyUseHTMLString:{type:Boolean,default:!1},duration:{type:Number,default:4500},iconClass:{type:String,default:""},id:{type:String,default:""},message:{type:[String,Object],default:""},offset:{type:Number,default:0},onClick:{type:Function,default:()=>{}},onClose:{type:Function,required:!0},position:{type:String,default:"top-right"},showClose:{type:Boolean,default:!0},title:{type:String,default:""},type:{type:String,default:""},zIndex:{type:Number,default:0}},emits:["destroy"],setup(e){const t=x.ref(!1);let n=null;const o=x.computed((()=>{const t=e.type;return t&&D[t]?`el-icon-${D[t]}`:""})),l=x.computed((()=>e.position.indexOf("right")>1?"right":"left")),i=x.computed((()=>e.position.startsWith("top")?"top":"bottom")),s=x.computed((()=>({[i.value]:`${e.offset}px`,"z-index":e.zIndex})));function a(){e.duration>0&&(n=setTimeout((()=>{t.value&&c()}),e.duration))}function r(){clearTimeout(n),n=null}function c(){t.value=!1}function u({code:e}){e===_.EVENT_CODE.delete||e===_.EVENT_CODE.backspace?r():e===_.EVENT_CODE.esc?t.value&&c():a()}return x.onMounted((()=>{a(),t.value=!0,k.on(document,"keydown",u)})),x.onBeforeUnmount((()=>{k.off(document,"keydown",u)})),{horizontalClass:l,typeClass:o,positionStyle:s,visible:t,close:c,clearTimer:r,startTimer:a}}});const j={key:0};O.render=function(e,t,n,o,l,i){return x.openBlock(),x.createBlock(x.Transition,{name:"el-notification-fade",onBeforeLeave:e.onClose,onAfterLeave:t[5]||(t[5]=t=>e.$emit("destroy"))},{default:x.withCtx((()=>[x.withDirectives(x.createVNode("div",{id:e.id,class:["el-notification",e.customClass,e.horizontalClass],style:e.positionStyle,role:"alert",onMouseenter:t[2]||(t[2]=(...t)=>e.clearTimer&&e.clearTimer(...t)),onMouseleave:t[3]||(t[3]=(...t)=>e.startTimer&&e.startTimer(...t)),onClick:t[4]||(t[4]=(...t)=>e.onClick&&e.onClick(...t))},[e.type||e.iconClass?(x.openBlock(),x.createBlock("i",{key:0,class:["el-notification__icon",[e.typeClass,e.iconClass]]},null,2)):x.createCommentVNode("v-if",!0),x.createVNode("div",{class:["el-notification__group",{"is-with-icon":e.typeClass||e.iconClass}]},[x.createVNode("h2",{class:"el-notification__title",textContent:x.toDisplayString(e.title)},null,8,["textContent"]),x.withDirectives(x.createVNode("div",{class:"el-notification__content",style:e.title?null:"margin: 0"},[x.renderSlot(e.$slots,"default",{},(()=>[e.dangerouslyUseHTMLString?(x.openBlock(),x.createBlock(x.Fragment,{key:1},[x.createCommentVNode(" Caution here, message could've been compromized, nerver use user's input as message "),x.createCommentVNode(" eslint-disable-next-line "),x.createVNode("p",{innerHTML:e.message},null,8,["innerHTML"])],2112)):(x.openBlock(),x.createBlock("p",j,x.toDisplayString(e.message),1))]))],4),[[x.vShow,e.message]]),e.showClose?(x.openBlock(),x.createBlock("div",{key:0,class:"el-notification__closeBtn el-icon-close",onClick:t[1]||(t[1]=x.withModifiers(((...t)=>e.close&&e.close(...t)),["stop"]))})):x.createCommentVNode("v-if",!0)],2)],46,["id"]),[[x.vShow,e.visible]])])),_:3},8,["onBeforeLeave"])},O.__file="packages/notification/src/index.vue";var E=Object.defineProperty,I=Object.defineProperties,V=Object.getOwnPropertyDescriptors,z=Object.getOwnPropertySymbols,H=Object.prototype.hasOwnProperty,L=Object.prototype.propertyIsEnumerable,F=(e,t,n)=>t in e?E(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;const P={"top-left":[],"top-right":[],"bottom-left":[],"bottom-right":[]};let $=1;const U=function(e={}){if(B.default)return;const t=e.position||"top-right";let n=e.offset||0;P[t].forEach((({vm:e})=>{n+=(e.el.offsetHeight||0)+16})),n+=16;const o="notification_"+$++,l=e.onClose;var i,s;i=((e,t)=>{for(var n in t||(t={}))H.call(t,n)&&F(e,n,t[n]);if(z)for(var n of z(t))L.call(t,n)&&F(e,n,t[n]);return e})({},e),s={onClose:()=>{!function(e,t,n){const o=P[t],l=o.findIndex((({vm:t})=>t.component.props.id===e));if(-1===l)return;const{vm:i}=o[l];if(!i)return;null==n||n(i);const s=i.el.offsetHeight,a=t.split("-")[0];o.splice(l,1);const r=o.length;if(!(r<1))for(let c=l;c<r;c++){const{el:e,component:t}=o[c].vm,n=parseInt(e.style[a],10)-s-16;t.props.offset=n}}(o,t,l)},offset:n,id:o,zIndex:N.default.nextZIndex()},e=I(i,V(s));const a=document.createElement("div"),r=x.createVNode(O,e,T.isVNode(e.message)?{default:()=>e.message}:null);return r.props.onDestroy=()=>{x.render(null,a)},x.render(r,a),P[t].push({vm:r}),document.body.appendChild(a.firstElementChild),{close:()=>{r.component.proxy.visible=!1}}};["success","warning","info","error"].forEach((e=>{Object.assign(U,{[e]:(t={})=>(("string"==typeof t||T.isVNode(t))&&(t={message:t}),t.type=e,U(t))})}));const A=U;A.install=e=>{e.config.globalProperties.$notify=A};var q=w.default=A;const R={style:{"over-flow-x":"auto",width:"100%"}},Z={class:"context"},G=g("br",null,null,-1),W=g("br",null,null,-1),Y=g("br",null,null,-1),J=g("i",{class:"el-icon-upload"},null,-1),K=g("div",{class:"el-upload_text"},[C(" 将文件拖到此处，或"),g("em",null,"点击上传")],-1),Q=g("div",{class:"el-upload_tip",slot:"tip"}," 只能上传zip格式文件 ",-1),X=g("br",null,null,-1),ee=C("提交"),te=g("br",null,null,-1),ne=g("br",null,null,-1),oe=g("br",null,null,-1),le={class:"time"},ie=g("i",{class:"el-icon-time"},null,-1),se=C(" 现在时间："),ae={style:{color:"rgb(85, 102, 196)"}},re=g("br",null,null,-1),ce=g("i",{class:"el-icon-time"},null,-1),ue=C(" 结束时间："),de={style:{color:"rgb(196, 85, 85)"}},pe=g("br",null,null,-1),fe={key:0},me=g("i",{class:"el-icon-warning",style:{color:"rgb(231, 78, 78)"}},[g("strong",null," 已结束")],-1);var ge=c({props:{contestId:{type:String,default:"0"},problemId:{type:String,default:"0"}},setup(o){const l=o;let i=u("作业名称"),s=u(),a=u(""),r=u(""),c=u(!1),C=u("");function w(){a.value=(new Date).format("yyyy-MM-dd hh:mm:ss"),setTimeout(w,1e3)}function x(e){const t=e.name.lastIndexOf("."),n="zip"==e.name.substr(t+1);console.log(e.type),n||q({title:"提示",message:"按照作业要求，请上传zip压缩包！",type:"warning",duration:3e3});const o=e.size/1024/1024<5;return o||q({title:"提示",message:"文件大小限制在5MB内，请删除作业中的无关文件重新上传！",type:"warning",duration:3e3}),n&&o}function _(e){q({title:"提示",message:"上传中，请稍候",type:"info",duration:2e3});let o=new FileReader;o.readAsDataURL(e.file),o.onload=async function(e){let o={data:{contestId:l.contestId,file:e.target.result}},i=await t(o);200==i.code?(n.push("/detailexpm/"+l.contestId+"/status"),q({title:"成功",message:"上传成功！将跳转至结果页面，如跳转未成功，请手动刷新",type:"success",duration:3e3})):401==i.code&&q({title:"失败",message:"上传失败！请重试",type:"error",duration:3e3}),s.value.clearFiles()}}function k(){s.value.submit()}function S(){q({title:"提示",message:"一次仅能上传一个文件",type:"warning",duration:3e3})}return d((async()=>{let t=(await e({contestId:l.contestId})).data;i.value=t.title,C.value=t.notification,r.value=function(e){let t=new Date(e);var n=t.getFullYear()+"-",o=(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-",l=t.getDate()<10?"0"+t.getDate():t.getDate(),i=(t.getHours()<10?"0"+t.getHours():t.getHours())+":",s=(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+":",a=t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds();return n+o+l+" "+i+s+a}(t.endTime),w(),c.value=new Date(a.value).getTime()-new Date(r.value).getTime()>0})),(e,t)=>{const n=p("el-page-header"),o=p("el-card"),l=p("el-col"),u=p("el-upload"),d=p("el-row"),w=p("el-button");return f(),m("div",null,[g(d,{gutter:20,class:"body"},{default:y((()=>[g("div",R,[g(l,{style:{width:"50%","min-width":"500px"}},{default:y((()=>[g(n,{onBack:t[1]||(t[1]=t=>e.$router.go(-1)),content:v(i),style:{"margin-bottom":"1em"}},null,8,["content"]),g(o,{style:{"min-height":"400px"}},{default:y((()=>[g("div",Z,[g("div",{id:"display",innerHTML:v(C),align:"left"},null,8,["innerHTML"])])])),_:1})])),_:1}),g(l,{style:{width:"50%"}},{default:y((()=>[g("div",null,[G,W,Y,g(d,{gutter:12,class:"row",style:{"text-align":"left"},type:"flex",justify:"center"},{default:y((()=>[g(u,{class:"uploadZipFile",ref:s,drag:"",action:"#","http-request":_,multiple:!1,"auto-upload":!1,"before-upload":x,limit:1,"on-exceed":S},{default:y((()=>[J,K,Q])),_:1},512)])),_:1}),X,g(d,{gutter:12,class:"row",style:{"text-align":"center"},type:"flex",justify:"center"},{default:y((()=>[g(w,{type:"primary",size:"medium",onClick:k},{default:y((()=>[ee])),_:1})])),_:1})]),te,ne,oe,g("div",le,[g("div",null,[ie,se,g("span",ae,b(v(a)),1)]),re,g("div",null,[ce,ue,g("span",de,b(v(r)),1)]),pe,v(c)?(f(),m("div",fe,[me])):h("",!0)])])),_:1})])])),_:1})])}}});export default ge;
