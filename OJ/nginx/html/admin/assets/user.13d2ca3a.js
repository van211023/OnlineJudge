import{p as e}from"./paginationlogic.22ec78bb.js";import{_ as l}from"./notification.8e3fe923.js";import"./index.4d66c970.js";import{d as a,r as t,b as o,c as s,i as d,k as n,A as i,F as u,l as r,n as p,a as c,g as m,p as g,e as f,h}from"./vendor.e45b1972.js";const y=r();g("data-v-60b65a0c");const v={class:"dialog-footer"},V=p("关 闭"),_=p("添 加"),b={class:"dialog-footer"},w=p("关 闭"),I=p("添 加"),C=d("p",null,[p(" 自动生成的用户名格式为team[递增编号]_[比赛编号]， "),d("br"),p("例如team123_12， "),d("br"),p("所以请确保开始编号没有和其他用户交叉 "),d("br")],-1),k={class:"dialog-footer"},z=p("关 闭"),x=p("添 加"),U=p("按照学校新建用户"),S=p("复制其他比赛用户"),j=p("引入已有用户"),P=p("从Excel添加"),D=p("保存更改"),A=p("移除");f();var E=a({expose:[],props:{contestId:{type:String,default:""}},setup(a){const r=a;let p=t([]),{currentPage:g,pageCount:f,pageSize:E,pageSizes:F,handlePage:T,handlePageSize:q}=e(p,{dataUrl:"admin/contest/user/list",otherParams:{contestId:r.contestId}});function B(){c.post("admin/contest/user/update",{data:p.value.map((e=>({userId:e.userId,nick:e.nick,password:e.password})))}).then((()=>l({title:"成功",message:"修改成功",type:"success"})))}o((async()=>{T(g.value)}));let G=t(),H=t(!1);async function J(){var e;try{await c.post("admin/contest/user/add",{data:{userId:null==(e=G.value)?void 0:e.toString(),contestId:r.contestId}}),l({title:"成功",message:"修改成功",type:"success"}),T(g.value),H.value=!1}catch{l({title:"失败",message:"修改失败",type:"error"})}}let K=t(),L=t(!1);async function M(){var e;try{await c.post("admin/contest/user/other/add",{data:{oldContestId:null==(e=K.value)?void 0:e.toString(),contestId:r.contestId}}),l({title:"成功",message:"复制成功",type:"success"}),T(g.value),L.value=!1}catch{l({title:"失败",message:"复制失败",type:"error"})}}let N=t(),O=t(),Q=t(""),R=t(!1);async function W(){var e,a;try{await c.post("admin/contest/user/group/add",{data:{startId:null==(e=N.value)?void 0:e.toString(),count:null==(a=O.value)?void 0:a.toString(),school:Q.value,contestId:r.contestId}}),l({title:"成功",message:"批量添加成功",type:"success"}),T(g.value),R.value=!1}catch{l({title:"失败",message:"批量添加失败",type:"error"})}}return(e,a)=>{const t=m("el-input-number"),o=m("el-form-item"),X=m("el-form"),Y=m("el-button"),Z=m("el-dialog"),$=m("el-input"),ee=m("el-table-column"),le=m("el-table"),ae=m("el-pagination");return h(),s(u,null,[d(Z,{title:"添加用户",width:"30%",modelValue:n(H),"onUpdate:modelValue":a[3]||(a[3]=e=>i(H)?H.value=e:H=e)},{footer:y((()=>[d("span",v,[d(Y,{onClick:a[2]||(a[2]=e=>i(H)?H.value=!1:H=!1)},{default:y((()=>[V])),_:1}),d(Y,{type:"primary",onClick:J},{default:y((()=>[_])),_:1})])])),default:y((()=>[d(X,null,{default:y((()=>[d(o,{label:"比赛用户ID"},{default:y((()=>[d(t,{modelValue:n(G),"onUpdate:modelValue":a[1]||(a[1]=e=>i(G)?G.value=e:G=e),"controls-position":"right",style:{width:"20em"},placeholder:"对应比赛用户表里面的userId"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1},8,["modelValue"]),d(Z,{title:"复制其他比赛用户",width:"30%",modelValue:n(L),"onUpdate:modelValue":a[6]||(a[6]=e=>i(L)?L.value=e:L=e)},{footer:y((()=>[d("span",b,[d(Y,{onClick:a[5]||(a[5]=e=>i(L)?L.value=!1:L=!1)},{default:y((()=>[w])),_:1}),d(Y,{type:"primary",onClick:M},{default:y((()=>[I])),_:1})])])),default:y((()=>[d(X,null,{default:y((()=>[d(o,{label:"比赛编号"},{default:y((()=>[d(t,{modelValue:n(K),"onUpdate:modelValue":a[4]||(a[4]=e=>i(K)?K.value=e:K=e),"controls-position":"right",style:{width:"20em"},placeholder:"另一场比赛的编号"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1},8,["modelValue"]),d(Z,{title:"按照学校新建用户",width:"30%",modelValue:n(R),"onUpdate:modelValue":a[11]||(a[11]=e=>i(R)?R.value=e:R=e)},{footer:y((()=>[d("span",k,[d(Y,{onClick:a[10]||(a[10]=e=>i(R)?R.value=!1:R=!1)},{default:y((()=>[z])),_:1}),d(Y,{type:"primary",onClick:W},{default:y((()=>[x])),_:1})])])),default:y((()=>[d(X,null,{default:y((()=>[d(o,{label:"开始编号"},{default:y((()=>[d(t,{modelValue:n(N),"onUpdate:modelValue":a[7]||(a[7]=e=>i(N)?N.value=e:N=e),"controls-position":"right",style:{width:"20em"},placeholder:"用户起始编号不要与现有的重复"},null,8,["modelValue"])])),_:1}),d(o,{label:"用户数量"},{default:y((()=>[d(t,{modelValue:n(O),"onUpdate:modelValue":a[8]||(a[8]=e=>i(O)?O.value=e:O=e),"controls-position":"right",style:{width:"20em"},placeholder:"需要创建用户的数量"},null,8,["modelValue"])])),_:1}),d(o,{label:"学校名称"},{default:y((()=>[d($,{modelValue:n(Q),"onUpdate:modelValue":a[9]||(a[9]=e=>i(Q)?Q.value=e:Q=e),placeholder:""},null,8,["modelValue"])])),_:1})])),_:1}),C])),_:1},8,["modelValue"]),d("span",null,[d(Y,{size:"small",icon:"el-icon-school",type:"primary",onClick:a[12]||(a[12]=e=>i(R)?R.value=!0:R=!0)},{default:y((()=>[U])),_:1}),d(Y,{size:"small",icon:"el-icon-document-copy",type:"primary",onClick:a[13]||(a[13]=e=>i(L)?L.value=!0:L=!0)},{default:y((()=>[S])),_:1}),d(Y,{size:"small",icon:"el-icon-plus",type:"primary",onClick:a[14]||(a[14]=e=>i(H)?H.value=!0:H=!0)},{default:y((()=>[j])),_:1}),d(Y,{size:"small",icon:"el-icon-document-add",type:"primary",onClick:a[15]||(a[15]=l=>e.alert("暂未实现"))},{default:y((()=>[P])),_:1}),d(Y,{size:"small",icon:"el-icon-upload",type:"success",onClick:B},{default:y((()=>[D])),_:1})]),d(le,{data:n(p),class:"editable",style:{width:"100%",height:"calc(100vh - 175px)","margin-top":"0.6em","margin-bottom":"5px"},height:"style.height","cell-style":{padding:"4px 0px"},"header-cell-style":{padding:"8px 0px"},stripe:"",border:!0,fit:""},{default:y((()=>[d(ee,{sortable:"",fixed:"",prop:"userId",label:"ID",width:"65"}),d(ee,{fixed:"",prop:"name",label:"赛队编号",width:"150"}),d(ee,{prop:"nick",label:"赛队名称(单击单元格编辑)"},{default:y((e=>[d($,{modelValue:e.row.nick,"onUpdate:modelValue":l=>e.row.nick=l},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),d(ee,{prop:"password",label:"赛队密码(可编辑)"},{default:y((e=>[d($,{modelValue:e.row.password,"onUpdate:modelValue":l=>e.row.password=l},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),d(ee,{prop:"ip",label:"登录ip",width:"170"}),d(ee,{prop:"registerTime",label:"注册时间",width:"170"}),d(ee,{prop:"school",label:"学校"}),d(ee,{fixed:"right",prop:"",label:"操作",width:"70"},{default:y((e=>[d(Y,{type:"danger",size:"mini",onClick:a=>async function(e){try{await c.post("admin/contest/user/delete",{data:{userId:e.toString(),contestId:r.contestId.toString()}}),l({title:"成功",message:"删除成功",type:"success"}),T(g.value)}catch{l({title:"失败",message:"删除失败",type:"error"})}}(e.row.userId)},{default:y((()=>[A])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),d(ae,{background:"",onSizeChange:n(q),onCurrentChange:n(T),"current-page":n(g),"page-sizes":n(F),"page-size":n(E),layout:"total, sizes, prev, pager, next, jumper",total:n(f)},null,8,["onSizeChange","onCurrentChange","current-page","page-sizes","page-size","total"])],64)}}});E.__scopeId="data-v-60b65a0c";export default E;
